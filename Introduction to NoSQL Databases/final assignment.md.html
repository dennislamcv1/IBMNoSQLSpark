<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.7.1/styles/default.min.css">
  </head>
  <body>
    <h1>Final Assignment - Querying data in NoSQL databases</h1>
    <center>
      <img src="https://gitlab.com/ibm/skills-network/courses/placeholder101/-/raw/master/labs/module%201/images/IDSNlogo.png" width="300" alt="cognitiveclass.ai logo">
    </center>
    <p>Estimated time needed: <strong>90</strong> minutes.</p>
    <p>It is highly recommened that you finish the <a href="https://labs.cognitiveclass.ai/tools/theia/?utm_medium=Exinfluencer&#x26;utm_source=Exinfluencer&#x26;utm_content=000026UJ&#x26;utm_term=10006555&#x26;utm_id=NA-SkillsNetwork-Channel-SkillsNetworkCoursesIBMDB0151ENSkillsNetwork24597197-2021-01-01&#x26;md_instructions_url=https%3A%2F%2Fcf-courses-data.s3.us.cloud-object-storage.appdomain.cloud%2FIBM-DB0151EN-SkillsNetwork%2Flabs%2FFinal+Assignment%2FSetup+and+Practice+Assignment.md" target="_blank">Setup and Practice Assignment Lab</a> before you proceed with this Assignment.</p>
    <h1>About This SN Labs Cloud IDE</h1>
    <p>This Skills Network Labs Cloud IDE provides a hands-on environment for course and project related labs. It utilizes Theia, an open-source IDE (Integrated Development Environment) platform, that can be run on desktop or on the cloud. To complete this lab, we will be using the Cloud IDE based on Theia and Cassandra and Mongodb running in a Docker container. You will also need an instance of Cloudant running in IBM Cloud.</p>
    <h2>Important Notice about this lab environment</h2>
    <p>Please be aware that sessions for this lab environment are not persisted. Every time you connect to this lab, a new environment is created for you. Any data you may have saved in the earlier session would get lost. Plan to complete these labs in a single session, to avoid losing your data.</p>
    <h1>Scenario</h1>
    <p>You are a data engineer at a data analytics consulting company. Your company prides itself in being able to efficiently handle data in any format on any database on any platform. Analysts in your office need to work with data on different databases, and data in different formats. While they are good at analyzing data, they count on you to be able to move data from external sources into various databases, move data from one type of database to another, and be able to run basic queries on various databases.</p>
    <h2>Objectives</h2>
    <p>In this assignment you will:</p>
    <ul>
      <li>replicate a Cloudant database.</li>
      <li>create indexes on a Cloudant database.</li>
      <li>query data in a Cloudant database.</li>
      <li>import data into a MongoDB database.</li>
      <li>query data in a MongoDB database.</li>
      <li>export data from MongoDB.</li>
      <li>import data into a Cassandra database.</li>
      <li>query data in a Cassandra database.</li>
    </ul>
    <h1>Note - Screenshots</h1>
    <p>Throughout this lab you will be prompted to take screenshots and save them on your own device. These screenshots will be needed to be uploaded for peer review in the next section of the course. You can use various free screengrabbing tools to do this or use your operating system's shortcut keys to do this (for example Alt+PrintScreen in Windows).</p>
    <h1>Exercise 1 - Check the lab environment</h1>
    <p>Before you proceed with the assignment :</p>
    <ul>
      <li>Check if you have the 'couchimport' tool installed on the lab, otherwise install it.</li>
      <li>Check if you have the 'mongoimport' and 'mongoexport' tools installed on the lab, otherwise install them.</li>
      <li>Check if the environment variable CLOUDANTURL is set, otherwise set it.</li>
    </ul>
    <h1>Exercise 2 - Working with a Cloudant database</h1>
    <h3>Task 1 - Replicate a remote database into your Cloudant instance</h3>
    <p>Using the replication page in the Cloudant dashboard, replicate the below source database using one time replication,</p>
    <p>Source</p>
    <p>Type : Remote Database</p>
    <p>Database URL: <a href="https://examples.cloudant.com/query-movies" target="_blank" rel="external">https://examples.cloudant.com/query-movies</a></p>
    <p>Authentication : None</p>
    <p>into a local database named movies.</p>
    <p>Once the replication is done take a screenshot of the database's dashboard (which shows database names, number of rows etc,).</p>
    <p>Name the screenshot as <code>1-replication.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 2 - Create an index for the "director" key, on the 'movies' database using the HTTP API</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>2-index-director.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 3 - Write a query to find all movies directed by 'Richard Gage' using the HTTP API</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>3-query-director.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 4 - Create an index for the "title" key, on the 'movies' database using the HTTP API</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>4-index-title.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 5 - Write a query to list only the "year" and "director" keys for the 'Top Dog' movies using the HTTP API</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>5-query-title.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 6 - Export the data from the 'movies' database into a file named 'movies.json'</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>6-couchexport.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h1>Exercise 3 - Working with a MongoDB database</h1>
    <h3>Task 7 - Import 'movies.json' into mongodb server into a database named 'entertainment' and a collection named 'movies'</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>7-mongoimport.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 8 - Write a mongodb query to find the year in which most number of movies were released</h3>
    <details>
      <summary>Click here for Hint</summary>The $sum operator when used with argument 1 can be used for counting.
      The below aggregation query gives you the count of movies directed by each director.
      <pre><code class="hljs language-json">
db.movies.aggregate([
{
    <span class="hljs-attr">"$group"</span>:{
        <span class="hljs-attr">"_id"</span>:<span class="hljs-string">"$director"</span>,
        <span class="hljs-attr">"moviecount"</span>:{<span class="hljs-attr">"$sum"</span>:<span class="hljs-number">1</span>}
        }
}
])
</code></pre>
      <p></p>
    </details>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>8-mongo-query.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 9 - Write a mongodb query to find the count of movies released after the year 1999</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>9-mongo-query.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 10. Write a query to find out the average votes for movies released in 2007</h3>
    <details>
      <summary>Click here for Hint</summary>
      <blockquote>
        <p>
          use the $match operator to filter for movies released in 2007.
          example usage: db.books.aggregate(
          [ { $match : { author : "john" } } ]
          )
          will filter out all the books written by the author <code>john</code>
        </p>
      </blockquote>
    </details>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>10-mongo-query.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 11 - Export the fields <code>_id</code>, "title", "year", "rating" and "director" from the 'movies' collection into a file named <code>partial_data.csv</code></h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>11-mongoexport.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h1>Exercise 4 - Working with a Cassandra database</h1>
    <h3>Task 12 - Import 'partial_data.csv' into cassandra server into a keyspace named 'entertainment' and a table named 'movies'</h3>
    <p>Note: While creating the table <code>movies</code> make the all the columns as text columns including the id column.</p>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>12-cassandra-import.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 13 - Write a cql query to count the number of rows in the 'movies' table</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>13-cassandra-query.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 14 - Create an index for the "rating" column in the 'movies' table using cql</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>14-cassandra-index.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <h3>Task 15 - Write a cql query to count the number of movies that are rated 'G'.</h3>
    <p>Take a screenshot of the command you used and the output.</p>
    <p>Name the screenshot as <code>15-cassandra-query.jpg</code>. (images can be saved with either .jpg or .png extension)</p>
    <p>End of assignment.</p>
    <h2>Authors</h2>
    <p>Ramesh Sannareddy</p>
    <h3>Other Contributors</h3>
    <p>Rav Ahuja</p>
    <h2>Change Log</h2>
    <table>
      <thead>
        <tr>
          <th>Date (YYYY-MM-DD)</th>
          <th>Version</th>
          <th>Changed By</th>
          <th>Change Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>2021-06-08</td>
          <td>0.4</td>
          <td>Malika Singla</td>
          <td>Updated task 10 to match rubric</td>
        </tr>
        <tr>
          <td>2021-04-23</td>
          <td>0.3</td>
          <td>Steve Ryan</td>
          <td>Review pass</td>
        </tr>
        <tr>
          <td>2021-04-16</td>
          <td>0.2</td>
          <td>Ramesh Sannareddy</td>
          <td>Reorganised the Exercises and Tasks</td>
        </tr>
        <tr>
          <td>2021-04-14</td>
          <td>0.1</td>
          <td>Ramesh Sannareddy</td>
          <td>Created initial version</td>
        </tr>
      </tbody>
    </table>
    <p>Copyright (c) 2021 IBM Corporation. All rights reserved.</p>
    <script>window.addEventListener('load', function() {
snFaculty.inject();
});</script>
    <script src="https://skills-network-assets.s3.us.cloud-object-storage.appdomain.cloud/scripts/inject.43989f87.js"></script>
    <script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.1/highlight.min.js"></script>
    <script src="https://unpkg.com/highlightjs-badge@0.1.9/highlightjs-badge.min.js"></script>
  </body>
</html>
